function calcCurrentStacksAndCubes(){setTimeout(function(){var t=$("#w1").val(),e=$("#w2").val(),a=$("#w3").val(),n=Math.ceil(t/216)+Math.ceil(e/168)+Math.ceil(a/112);$("#ssc").val(n)},100)}function calcTempStacksAndCubesRemove(t,e,a,n){for(var r=t,s=e,l=a,c=[],d=n.length-1;d>=0;d--){var i=n[d][1],o=n[d][2],p=n[d][3],I=n[d][0],v=0,u=0,g=0;s-=o,l-=p;var h="no";if((r-=i)>0?(v=i,h="yes"):i+r>0&&(h="yes",v=i+r),s>0?(u=o,h="yes"):o+s>0&&(h="yes",u=o+s),l>0?(g=p,h="yes"):p+l>0&&(h="yes",g=p+l),"yes"==h){var f="no";v+u+g==216&&(f="yes");var y=[I,v,u,g,f];c.push(y)}}renderRemovedStacksInfo(c);for(d=0;d<c.length;d++){n=rearraangeCubes(n,c[d][0],c[d][1],c[d][2],c[d][3],c[d][4])}return n=removeZeroStacks(n)}function removeZeroStacks(t){for(var e=[],a=0;a<t.length;a++){var n=t[a][0],r=t[a][1],s=t[a][2],l=t[a][3],c=t[a][4];if(r>0||s>0||l>0){var d=[n,r,s,l,c];e.push(d)}}return e}function rearraangeCubes(t,e,a,n,r,s){for(var l=0;l<t.length;l++)if(t[l][0]==e){a=t[l][1]-a,n=t[l][2]-n,r=t[l][3]-r;t[l]=[e,a,n,r,"no"]}return t}function calcTempStacksAndCubesAdd(t,e,a,n){for(var r=[],s=0,l=0,c=0,d=0,i=0;i<n.length;i++)"no"==n[i][4]?(l=n[i][1],c=n[i][2],d=n[i][3],t=parseInt(t)+l,e=parseInt(e)+c,a=parseInt(a)+d):s++;var o=t,p=e,I=a,v=216,u=((t+e+a)/v).toFixed(2),g=(t/u).toFixed(),h=(e/u).toFixed(),f=v-(parseInt(g)+parseInt(h)),y="TOPLAMINA";h>160&&(g=(t/(u=(e/(h=160)).toFixed(2))).toFixed(),h=(e/u).toFixed(),f=v-(parseInt(g)+parseInt(h)),y="MEDIUMLAMINA"),f>104&&(g=(t/(u=(a/(f=104)).toFixed(2))).toFixed(),h=(e/u).toFixed(),y="LOWLAMINA"),g=parseInt(g),h=parseInt(h),f=parseInt(f),n.splice(s);var x=parseInt(n.length);for(i=0;i<=parseInt(u);i++){x+=1;var $=0,w=0,k=0;o>0&&(o-=w=g)<=0&&(w=g+o,o=0),p>0&&(p-=$=h)<=0&&($=h+p,p=0),I>0&&(I-=k=f)<=0&&(k=f+I,I=0);var S=parseInt(w)+parseInt($)+parseInt(k),m="no";if(S==v)m="yes";else{var A=v-S;A=parseInt(A),"MEDIUMLAMINA"==y&&(S>168&&S<194&&($=160),S<168&&($=162),o>0&&((w+=A)>o?(w=o+(w-A),o-=A):o-=A),A=v-(S=parseInt(w)+parseInt($)+parseInt(k)),I>0&&A>0&&((k+=A)>I?(k=I+(k-A),I-=A):I-=A)),"LOWLAMINA"==y&&(S>168&&S<194&&(f=106),S<168&&(f=112),A=v-(S=parseInt(w)+parseInt($)+parseInt(k)),p>0&&(($+=A)>p?($=p+($-A),p-=A):p-=A),A=v-(S=parseInt(w)+parseInt($)+parseInt(k)),o>0&&A>0&&((w+=A)>o?(w=o+(w-A),o-=A):o-=A)),m="no",(S=parseInt(w)+parseInt($)+parseInt(k))==v&&(m="yes")}var b=[x,w,$,k,m];n.push(b),r.push(b)}return renderReceivedStacksInfo(r,l,c,d),n}function calcStacksAndCubes(t,e,a){for(var n=((t+e+a)/216).toFixed(2),r=(t/n).toFixed(),s=(e/n).toFixed(),l=216-(parseInt(r)+parseInt(s)),c=[],d=1;d<=parseInt(n)+1;d++){var i=d,o=d*r,p=parseInt(r);o>t&&(p=o=parseInt(parseInt(t)+parseInt(r))-d*r);var I=d*s,v=parseInt(s);I>e&&(v=I=parseInt(parseInt(e)+parseInt(s))-d*s);var u=d*l,g=parseInt(l);u>a&&(g=u=parseInt(parseInt(a)+parseInt(l))-d*l);var h="no";216==parseInt(p)+parseInt(v)+parseInt(g)&&(h="yes");var f=[i,p,v,g,h];c.push(f)}return c}function renderRemovedStacksInfo(t){for(var e='<div class="calcInDiv"><h3>Cubes To Remove from Stack</h3><table cellpadding="5" rules="rows" cellspacing = "0"><tr><th>Stack No</th><th>Lamina Top</th><th>Medium</th><th>Low</th><th>Stack Full</th></tr>',a=0,n=0,r=0,s=0;s<t.length;s++)a+=t[s][1],n+=t[s][2],r+=t[s][3],e+='<tr><td style="text-align:center;">'+t[s][0]+"</td>",e+='<td style="text-align:center;">'+t[s][1]+"</td>",e+='<td style="text-align:center;">'+t[s][2]+"</td>",e+='<td style="text-align:center;">'+t[s][3]+"</td>",e+='<td style="text-align:center;">'+t[s][4]+"</td></tr>";e+='<tr><td style="text-align:center;">Total</td>',e+='<td style="text-align:center;">'+a+"</td>",e+='<td style="text-align:center;">'+n+"</td>",e+='<td style="text-align:center;">'+r+"</td>",e+='<td style="text-align:center;"></td></tr>',e+="</table></div>",$("body").append(e),$("#ssp").val(t.length)}function renderReceivedStacksInfo(t,e,a,n){var r='<div class="calcInDiv"><h3>Cubes To Add in Stacks</h3><table cellpadding="5" rules="rows" cellspacing = "0"><tr><th>Stack No</th><th>Lamina Top</th><th>Medium</th><th>Low</th><th>Stack Full</th></tr>';r+='<tr><td style="text-align:center;" colspan="5"><h4>Previous unfilled Stack Cubes</h4></td></tr>',r+='<tr><td style="text-align:center;">Total</td>',r+='<td style="text-align:center;">'+e+"</td>",r+='<td style="text-align:center;">'+a+"</td>",r+='<td style="text-align:center;">'+n+"</td>",r+='<td style="text-align:center;"></td></tr>',r+='<tr><td style="text-align:center;" colspan="5"><h4>After all cubes arrangement</h4></td></tr>';for(var s=0,l=0,c=0,d=0;d<t.length;d++)s+=t[d][1],l+=t[d][2],c+=t[d][3],r+='<tr><td style="text-align:center;">'+t[d][0]+"</td>",r+='<td style="text-align:center;">'+t[d][1]+"</td>",r+='<td style="text-align:center;">'+t[d][2]+"</td>",r+='<td style="text-align:center;">'+t[d][3]+"</td>",r+='<td style="text-align:center;">'+t[d][4]+"</td></tr>";r+='<tr><td style="text-align:center;">Total</td>',r+='<td style="text-align:center;">'+s+"</td>",r+='<td style="text-align:center;">'+l+"</td>",r+='<td style="text-align:center;">'+c+"</td>",r+='<td style="text-align:center;"></td></tr>',r+="</table></div>",$("body").append(r)}function renderStacksInfo(t){if(stackCreate(),cloneStack(28,t),t.length>28)return alert("Stacks limit exceeded"),!1;$("#ssp").val(t.length)}$(document).ready(function(){var t;setTimeout(function(){$("#arrangeOpening").click()},500),$(document).on("click","#arrangeOpening",function(){var e=parseInt($("#w1").val()),a=parseInt($("#w2").val()),n=parseInt($("#w3").val());renderStacksInfo(t=calcStacksAndCubes(e,a,n)),calcCurrentStacksAndCubes()}),$(document).on("click","#inarrange",function(){var e=parseInt($("#w1").val()),a=parseInt($("#w2").val()),n=parseInt($("#w3").val()),r=$("#iw1").val(),s=$("#iw2").val(),l=$("#iw3").val();if(""==r||""==s||""==l)return!1;$("#iw1,#iw2,#iw3").val(""),$("#w1").val(parseInt(e)+parseInt(r)),$("#w2").val(parseInt(a)+parseInt(s)),$("#w3").val(parseInt(n)+parseInt(l)),renderStacksInfo(t=calcTempStacksAndCubesAdd(r,s,l,t)),calcCurrentStacksAndCubes()}),$(document).on("click","#outarrange",function(){var e=parseInt($("#w1").val()),a=parseInt($("#w2").val()),n=parseInt($("#w3").val()),r=$("#ow1").val(),s=$("#ow2").val(),l=$("#ow3").val();if(""==r||""==s||""==l)return!1;$("#ow1,#ow2,#ow3").val(""),$("#w1").val(parseInt(e)-parseInt(r)),$("#w2").val(parseInt(a)-parseInt(s)),$("#w3").val(parseInt(n)-parseInt(l));e=parseInt($("#w1").val()),a=parseInt($("#w2").val()),n=parseInt($("#w3").val());renderStacksInfo(t=calcTempStacksAndCubesRemove(r,s,l,t)),calcCurrentStacksAndCubes()})});